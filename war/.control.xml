<!-- 
//
//Copyright (c) 2009,2010 Michael Toth
//Spiralcraft Inc., All Rights Reserved
//
//This package is part of the Spiralcraft project and is licensed under
//a multiple-license framework.
//
//You may not use this file except in compliance with the terms found in the
//SPIRALCRAFT-LICENSE.txt file at the top of this distribution, or available
//at http://www.spiralcraft.org/licensing/SPIRALCRAFT-LICENSE.txt.
//
//Unless otherwise agreed to in writing, this software is distributed on an
//"AS IS" basis, WITHOUT WARRANTY OF ANY KIND, either express or implied.
//
-->
<af:AutoFilter.list
  xmlns:af="class:/spiralcraft/servlet/autofilter/"
  xmlns:smtp="class:/spiralcraft/net/smtp/"
  xmlns:webui="class:/spiralcraft/servlet/webui/"
  xmlns:config="context://config/"
  xmlns:http="class:/javax/servlet/http/"
  xmlns:task="class:/spiralcraft/task/"
  >
    
  <af:ReferenceFocusFilter>

    <typeURI>context://config/FileSpace
    </typeURI>
                
    <scope>CONSTANT
    </scope>
    
  </af:ReferenceFocusFilter>

  <config:FilesPublishFilter/>
  

 
  
  <config:DataSnapshotFilter/>
  
  <af:ReferenceFocusFilter>
        
    <instanceURI>context://config/MonitorScheduler.xml
    </instanceURI>
        
  </af:ReferenceFocusFilter>   
  
  <af:TaskFilter>
    <debug>true
    </debug>
    
    <whenX>
      [http:HttpServletRequest].servletPath.startsWith("/id/")
    </whenX>
    
    <task>
      <task:Eval>
        <contextX>
          [#context] { 
          
            slug:=[http:HttpServletRequest].servletPath.substring(4)
            ,search:=.slug.endsWith("/")?.slug{.substring(0,.length()-1)}:.slug
            ,location:="/"+.search+".webui"
          }
        </contextX>
        
        <x>
          [http:HttpServletResponse].sendRedirect(location)
        </x>
      </task:Eval>
    </task>
       
    <outputX>null
    </outputX>
    
    <renderWhenX>true
    </renderWhenX>
            
  </af:TaskFilter>   
  
</af:AutoFilter.list>
  